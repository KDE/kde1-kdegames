# This is a sample Makefile.in 

kde_libraries = @kde_libraries@
qt_libraries = @qt_libraries@
top_builddir = ..
LIBTOOL = @LIBTOOL@
KDE_RPATH = @KDE_RPATH@
topdir = @topdir@
SHELL = /bin/sh

# @CXXFLAGS@     : is set to -g -Wall (when debuging) or -O2 -Wall (when not)
# @all_includes@ : is set to all needed include paths for QT, KDE and X11
# -I.. 	         : needed for config.h
CXXFLAGS= @CXXFLAGS@ @all_includes@ -DHAVE_CONFIG_H -I.. -IQwSpriteField

# @LDFLAGS@    : is set to -s (when not debuging) for stripping
# @all_libra.@ : is set to all needed libraries paths for QT, KDE and X11
# you need also @LIBSOCKET@, if you link with -lkfm
LDFLAGS	= @LDFLAGS@ @all_libraries@ -L$(topdir)/kasteroids/QwSpriteField -lkdecore -lkdeui -lSpriteField -lqt -lXext -lX11 @LIBSOCKET@

# both are clear, I think
CXX     = @CXX@
MOC   	= @MOC@

############# INSTALL #################

install = @INSTALL@
INSTALL = $(install) -m 0755
INSTALL_DATA = $(install) -m 0644
INSTALL_DIR = $(SHELL) @top_srcdir@/mkinstalldirs

prefix = @prefix@
BINDIR = $(prefix)/bin
PICSDIR = $(prefix)/share/apps/kasteroids/sprites
APPSDIR = $(prefix)/share/applnk/Games
ICONDIR = $(prefix)/share/icons
DOCSDIR = $(prefix)/share/doc/HTML/en/kasteroids

########### File Formats ###########

.SUFFIXES: .cpp .moc

.cpp.o:
	$(CXX) -c $(CXXFLAGS) $<

.h.moc: 
	$(MOC) $< -o $@

########## Files #####################

OBJECTS =	main.o view.o toplevel.o kfixedtopwidget.o kastmsg.o
SRCMETA =	view.moc toplevel.moc kfixedtopwidget.moc
TARGET	=	kasteroids

######### build rules ################

all: QwSpriteLib $(TARGET)

Makefile: Makefile.in
	cd .. && CONFIG_FILES=kasteroids/$@ CONFIG_HEADERS= $(SHELL) ./config.status

QwSpriteLib:
	(cd QwSpriteField; $(MAKE) all)

$(TARGET): $(SRCMETA) $(OBJECTS)
	$(LIBTOOL) --mode=link $(CXX) $(OBJECTS) -o $(TARGET) $(LDFLAGS) $(KDE_RPATH)

clean:
	rm -f *.o *.bak *~ *% #*
	rm -f $(SRCMETA) $(TARGET)
	(cd sprites && $(MAKE) clean)
	(cd QwSpriteField && $(MAKE) clean)

distclean: clean
	(cd QwSpriteField && $(MAKE) distclean)
	(cd sprites && $(MAKE) distclean)
	rm -f Makefile

install: install-exec install-data

install-exec: all
	$(INSTALL_DIR) $(BINDIR)
	$(INSTALL) $(TARGET) $(BINDIR)

install-data:
	$(INSTALL_DIR) $(PICSDIR)
	$(INSTALL_DATA) bg.ppm $(PICSDIR)
	$(INSTALL_DIR) $(APPSDIR)
	$(INSTALL_DATA) Kasteroids.kdelnk $(APPSDIR)
	$(INSTALL_DIR) $(ICONDIR)
	$(INSTALL_DATA) kasteroids.xpm $(ICONDIR)
	$(INSTALL_DIR) $(ICONDIR)/mini
	$(INSTALL_DATA) mini-kasteroids.xpm $(ICONDIR)/mini/kasteroids.xpm
	$(INSTALL_DIR) $(DOCSDIR)
	$(INSTALL_DATA) html/index.html $(DOCSDIR)
	(cd sprites && $(MAKE) install)
 
uninstall:
	rm -f $(BINDIR)/$(TARGET)
	rm -f $(PICSDIR)/bg.ppm
	rm -f $(APPSDIR)/Kasteroids.kdelnk	
	(cd sprites && $(MAKE) uninstall)

